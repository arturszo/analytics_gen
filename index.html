<html>
    <head>
        <meta charset="UTF-8">

        <link rel="stylesheet" href="themes/default/style.min.css" />

        <script src="https://code.jquery.com/jquery-1.12.1.min.js"></script>
        <script src="jstree.min.js"></script>
    </head>

    <body>
        <div id="source_title"></div>
        <div id="source_date"></div>
        <div id="source_pages"></div>
        <div id="source_number"></div>
        <div id="source_issn"></div>

        <div id="test_tree"></div>


    <script>
            var data = [
                { "id" : "root", "parent" : "#", "text" : "Izdevums" }]

        jQuery(function($){
                $('#test_tree').jstree({
                    "core": {
                        "data": data
                    },
                    "plugins" : ["checkbox"]});
            })

            var tree_html = ""

            $.ajax({
                type: "GET",
	            url: "data/diea2016n042_mets.xml",
	            dataType: "xml",
	            success: function(xml) {
                    $(xml).find("mods\\:identifier").each(function(){
                        document.getElementById("source_issn").innerHTML = "ISSN: " + $(this).text()
                        })
                    $(xml).find("mods\\:dateIssued").each(function(){
                        document.getElementById("source_date").innerHTML = "Datums: " + $(this).text()
                        })
                    $(xml).find("mods\\:partNumber").each(function(){
                        if ($(this).parent().attr("type") == "issue")
                            document.getElementById("source_number").innerHTML = "Nr: " + $(this).text()
                        if ($(this).parent().attr("type") == "pages")
                            document.getElementById("source_pages").innerHTML = "Lpp: " + $(this).text()
                        })
                    $(xml).find("mods\\:title").each(function(){
                        if ($(this).parent().parent().attr("type") == "host")
                            document.getElementById("source_title").innerHTML = "Avots: " + $(this).text()
                        })


                    //////////////////////
                    /// BUILD THE TREE ///
                    //////////////////////


                    $(xml).find("mets\\:div").each(function(){
                        if ($(this).get(0).hasAttribute("DMDID")) {
                            if ($(this).attr("DMDID").substr(0,11) == "modssection"){
                                //alert($(this).attr("DMDID"))
                                //alert($(this).attr("LABEL"))
                                $('#test_tree').jstree().create_node('root', {"id": "abc", "text":"def"}, "last")
                                }
                            }
                        }
                    )
                    $('#test_tree').jstree().redraw()


                } //end of success
            })
    </script>
    </body>
</html>
